---
name: service-backup

description: |
  Service Backup provides ability to upload the backup produced by a service
  to an S3-API-compatible blobstore.

templates:
  ctl.erb: bin/ctl

packages:
- service-backup
- aws-cli

properties:

  ################################# BACKUP #################################

  service-backup.destination.s3.endpoint_url:
    default: https://s3.amazonaws.com
    description: URL of the blobstore endpoint. Override this to use an S3-compatible blobstore like RiakS2.

  service-backup.destination.s3.bucket_name:
    default: ""
    description: Bucket to which backups are uploaded

  service-backup.destination.s3.bucket_path:
    default: ""
    description: Path in bucket to which backups are uploaded

  service-backup.destination.s3.access_key_id:
    default: ""
    description: AWS Access Key to access the blobstore

  service-backup.destination.s3.secret_access_key:
    default: ""
    description: AWS Secret Access Key to access the blobstore

  service-backup.destination.scp.user:
    default: ""
    description: SCP user on remote server

  service-backup.destination.scp.server:
    default: ""
    description: SCP remote server host

  service-backup.destination.scp.destination:
    default: ""
    description: Remote path on server for upload

  service-backup.destination.scp.key:
    default: ""
    description: SSH key identity file for remote server

  service-backup.destination.scp.port:
    default: 22
    description: SSH port on remote server

  service-backup.source_folder:
    description: Local path from which backups are uploaded. All files in here are uploaded.

  service-backup.source_executable:
    description: Local executable to create backups. Tokens are split on spaces; first is command to execute and remaining are passed as args to command.

  service-backup.cleanup_executable:
    description: Local executable to cleanup backups. Tokens are split on spaces; first is command to execute and remaining are passed as args to command.
    default: ""

  service-backup.cron_schedule:
    description: Schedule on which to perform backups. Supports "* * * * *" syntax.

  service-backup.missing_properties_message:
    default: Provide these missing fields in your manifest.
    description: Custom message to show when required backup parameters are not present.
